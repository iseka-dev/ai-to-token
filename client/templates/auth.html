<div>
    <div>
        <button id="onboardButton">Install metamask</button>
    </div>
    <div style="margin-top: 2vw;">
        <button class="enableEthereumButton">Show Account</button>
        <h2 style="font-family: acidFont, Helvetica">Account: <span class="showAccount"></span></h2>
    </div>
</div>
<script>
    window.addEventListener("DOMContentLoaded", () => {
        const onboarding = new MetaMaskOnboarding();
        const onboardButton = document.getElementById("onboardButton");
        const showAccount = document.querySelector('.showAccount');
        let accounts;
        const updateButton = () => {
            if (!MetaMaskOnboarding.isMetaMaskInstalled()) {
                onboardButton.innerText = "Click here to install MetaMask!";
                onboardButton.onclick = () => {
                    onboardButton.innerText = "Onboarding in progress";
                    onboardButton.disabled = true;
                    onboarding.startOnboarding();
                };
            } else if (accounts && accounts.length > 0) {
                onboardButton.innerText = "Connected";
                onboardButton.disabled = true;
                showAccount.innerHTML = ""
                onboarding.stopOnboarding();
            } else {
                onboardButton.innerText = "Connect";
                onboardButton.disabled = false;
                onboardButton.onclick = async () => {
                    const acc = await window.ethereum.request({
                        method: "eth_requestAccounts",
                    }).catch((err) => {
                        if (err.code === 4001) {
                            console.log('Please connect to MetaMask.');
                        } else {
                            console.error(err);
                        }
                    });
                    if (acc && acc.length > 0) {
                        onboardButton.innerText = "Connected";
                        onboardButton.disabled = true;
                    }
                };
            }
        };
        updateButton();
        if (MetaMaskOnboarding.isMetaMaskInstalled()) {
            window.ethereum.on('accountsChanged', (newAccounts) => {
                accounts = newAccounts;
                updateButton();
            });
        }
    });
</script>
